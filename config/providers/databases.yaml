# Database Service Configuration
# Public config - safe to commit to git
# Passwords are in .env (gitignored)

# ============================================
# QUEUE SETTINGS (Internal client queues)
# ============================================
queue:
  size: 2000              # Internal queue size for insert operations
  workers: 3              # Worker pool size (fewer workers, already batches)
  batch_size: 100         # Batch size for inserts

# ============================================
# CLICKHOUSE - Time-Series OLAP Database
# ============================================
clickhouse:
  # Connection
  # Docker network hostname (services run inside Docker)
  # Use 'localhost' only when running services on host machine
  host: clickhouse
  port: 9000  # Native protocol
  http_port: 8123  # HTTP interface

  # Database
  database: trading
  user: trading_user
  # password: Set via CLICKHOUSE_PASSWORD in .env

  # Performance
  max_threads: 4
  max_memory_usage_gb: 2

  # Connection pooling
  # Pool size should be >= DB_WORKERS for optimal throughput
  # Each worker needs a connection when executing queries
  pool_size: 3  # Default: same as DB_WORKERS (from queue.workers)

# ============================================
# POSTGRESQL - Relational Database
# ============================================
postgres:
  # Connection
  # Docker network hostname (services run inside Docker)
  # Use 'localhost:5433' only when running services on host machine
  host: postgres
  port: 5432  # Internal Docker port

  # Database
  database: trading
  user: trading_user
  # password: Set via POSTGRES_PASSWORD in .env

  # Connection pooling
  min_pool_size: 2
  max_pool_size: 10

# ============================================
# REDIS - In-Memory Cache
# ============================================
redis:
  # Connection
  # Docker network hostname (services run inside Docker)
  # Use 'localhost' only when running services on host machine
  host: redis
  port: 6379

  # Database selection
  db: 0

  # Optional password: Set via REDIS_PASSWORD in .env
  # For local dev, no password is fine

  # Performance
  max_connections: 50
  socket_timeout_sec: 5

  # Queue settings (internal client queue)
  queue:
    size: 1000            # Internal queue size for enqueue_set operations
    workers: 2            # Worker pool size (low volume)
